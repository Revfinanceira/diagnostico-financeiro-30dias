<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 8: Eliminando o Controle Obsessivo - Revolu√ß√£o Financeira em 30 Dias</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .progress-container {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 2px solid #e9ecef;
        }

        .progress-bar {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 10px;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 4px;
            background: #e9ecef;
            z-index: 1;
        }

        .progress-line-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .progress-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 4px solid #e9ecef;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #adb5bd;
            transition: all 0.3s ease;
        }

        .progress-step.active .progress-circle {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.1);
        }

        .progress-step.completed .progress-circle {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }

        .progress-label {
            font-size: 0.85em;
            color: #6c757d;
            font-weight: 500;
        }

        .progress-step.active .progress-label {
            color: #667eea;
            font-weight: 600;
        }

        .content {
            padding: 40px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-size: 2em;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .step-description {
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.3em;
            color: #667eea;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .info-box {
            background: #e0e7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .info-box p {
            color: #4c51bf;
            margin: 5px 0;
            line-height: 1.6;
        }

        .info-box strong {
            color: #667eea;
        }

        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success-box p {
            color: #065f46;
            margin: 5px 0;
            line-height: 1.6;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .warning-box p {
            color: #92400e;
            margin: 5px 0;
            line-height: 1.6;
        }

        .rule-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            position: relative;
        }

        .rule-number {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1em;
        }

        .rule-structure {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 2px dashed #cbd5e0;
        }

        .rule-part {
            margin-bottom: 15px;
        }

        .rule-part:last-child {
            margin-bottom: 0;
        }

        .rule-label {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
            font-size: 0.95em;
        }

        .rule-if {
            color: #dc2626;
        }

        .rule-then {
            color: #059669;
        }

        .rule-because {
            color: #ea580c;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
            font-size: 0.95em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
        }

        .nav-button {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }

        .nav-button.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .nav-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .nav-button.secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .nav-button.secondary:hover {
            background: #f0f4ff;
        }

        .add-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .add-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .remove-button {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remove-button:hover {
            background: #dc2626;
        }

        .trigger-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #10b981;
        }

        .trigger-type {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .trigger-tech {
            background: #dbeafe;
            color: #1e40af;
        }

        .trigger-env {
            background: #d1fae5;
            color: #065f46;
        }

        .trigger-social {
            background: #fef3c7;
            color: #92400e;
        }

        .example-card {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 3px solid #667eea;
        }

        .example-title {
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .review-schedule {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 3px solid #f59e0b;
        }

        .schedule-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .schedule-item:last-child {
            margin-bottom: 0;
        }

        .schedule-frequency {
            font-weight: 700;
            color: #92400e;
            margin-bottom: 5px;
        }

        .download-section {
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .download-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .download-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .print-view {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 9999;
            overflow-y: auto;
            padding: 40px;
        }

        .print-view.active {
            display: block !important;
        }

        .print-content {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .print-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .print-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 10000;
        }
        
        .print-view:not(.active) .print-buttons {
            display: none;
        }
        
        .print-view.active .print-buttons {
            display: flex !important;
        }

        .print-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .print-btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .print-btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .print-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        @media print {
            .print-buttons {
                display: none !important;
            }
            
            .print-content {
                box-shadow: none;
                padding: 0;
            }
            
            .print-view {
                padding: 0;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 20px;
            }

            .rule-number {
                position: static;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† Aula 8: Eliminando o Controle Obsessivo</h1>
            <p>Crie regras autom√°ticas e libere sua mente para o que importa</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressFill"></div>
                </div>
                <div class="progress-step active" data-step="1">
                    <div class="progress-circle">1</div>
                    <div class="progress-label">Regras</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="progress-circle">2</div>
                    <div class="progress-label">Gatilhos</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="progress-circle">3</div>
                    <div class="progress-label">Revis√µes</div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- PASSO 1: CRIAR REGRAS -->
            <div class="step active" id="step1">
                <h2 class="step-title">üìù Passo 1: Crie Suas Regras Financeiras</h2>
                <p class="step-description">Crie 5 regras usando a estrutura SE-ENT√ÉO-PORQUE para eliminar decis√µes recorrentes.</p>

                <div class="info-box">
                    <p><strong>üß† O Custo do Controle Obsessivo:</strong></p>
                    <p>‚Ä¢ Tomamos cerca de <strong>70-80 decis√µes financeiras por dia</strong></p>
                    <p>‚Ä¢ Isso consome at√© <strong>25% da energia mental</strong> dispon√≠vel</p>
                    <p>‚Ä¢ Aumenta em <strong>43%</strong> a chance de escolhas impulsivas</p>
                    <p>‚Ä¢ Sistemas com regras pr√©-definidas t√™m <strong>3,7x mais sucesso</strong></p>
                </div>

                <div class="warning-box">
                    <p><strong>üìê Estrutura da Regra Perfeita:</strong></p>
                    <p><span style="color: #dc2626; font-weight: 600;">SE</span> [situa√ß√£o espec√≠fica e identific√°vel]</p>
                    <p><span style="color: #059669; font-weight: 600;">ENT√ÉO</span> [a√ß√£o clara e n√£o amb√≠gua]</p>
                    <p><span style="color: #ea580c; font-weight: 600;">PORQUE</span> [conex√£o emocional com seu sonho]</p>
                </div>

                <div class="section">
                    <div class="section-title">Exemplos de Regras Eficazes</div>
                    
                    <div class="example-card">
                        <div class="example-title">Exemplo 1: Compras N√£o Planejadas</div>
                        <p><span class="rule-label rule-if">SE</span> uma compra n√£o planejada custar mais de R$ 200</p>
                        <p><span class="rule-label rule-then">ENT√ÉO</span> esperarei 24 horas antes de decidir</p>
                        <p><span class="rule-label rule-because">PORQUE</span> cada decis√£o impulsiva adia a viagem para Portugal</p>
                    </div>

                    <div class="example-card">
                        <div class="example-title">Exemplo 2: Dinheiro Extra</div>
                        <p><span class="rule-label rule-if">SE</span> receber dinheiro extra n√£o previsto</p>
                        <p><span class="rule-label rule-then">ENT√ÉO</span> 50% vai automaticamente para a Conta Sonhos</p>
                        <p><span class="rule-label rule-because">PORQUE</span> acelera a compra do meu apartamento</p>
                    </div>

                    <div class="example-card">
                        <div class="example-title">Exemplo 3: Assinaturas</div>
                        <p><span class="rule-label rule-if">SE</span> estiver considerando uma assinatura ou compra recorrente</p>
                        <p><span class="rule-label rule-then">ENT√ÉO</span> multiplicarei o valor por 12 antes de decidir</p>
                        <p><span class="rule-label rule-because">PORQUE</span> compromissos recorrentes afetam minha liberdade financeira</p>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Suas 5 Regras Financeiras</div>
                    <div id="rulesContainer"></div>
                    <button class="add-button" onclick="addRule()" id="addRuleBtn">
                        ‚ûï Adicionar Regra
                    </button>
                </div>

                <div class="navigation">
                    <button class="nav-button primary" onclick="nextStep()">
                        Pr√≥ximo: Criar Gatilhos ‚Üí
                    </button>
                </div>
            </div>

            <!-- PASSO 2: GATILHOS -->
            <div class="step" id="step2">
                <h2 class="step-title">üéØ Passo 2: Configure Gatilhos Autom√°ticos</h2>
                <p class="step-description">Crie 3 gatilhos (tecnol√≥gico, ambiental e social) para suas regras mais importantes.</p>

                <div class="info-box">
                    <p><strong>üîÑ O Poder dos Gatilhos Autom√°ticos:</strong></p>
                    <p>‚Ä¢ <strong>Tecnol√≥gicos:</strong> Apps, alertas, automa√ß√µes banc√°rias</p>
                    <p>‚Ä¢ <strong>Ambientais:</strong> Organiza√ß√£o f√≠sica, lembretes visuais</p>
                    <p>‚Ä¢ <strong>Sociais:</strong> Parceiros de presta√ß√£o de contas, compromissos p√∫blicos</p>
                    <p><br>Gatilhos eliminam a necessidade de decidir no momento da tenta√ß√£o!</p>
                </div>

                <div class="section">
                    <div class="section-title">Exemplos de Gatilhos por Tipo</div>
                    
                    <div class="trigger-card">
                        <div class="trigger-type trigger-tech">üíª Tecnol√≥gico</div>
                        <p><strong>Exemplos:</strong></p>
                        <p>‚Ä¢ Configurar alertas no app banc√°rio para gastos acima de R$ 200</p>
                        <p>‚Ä¢ Usar apps como Mobills, Organizze ou GuiaBolso com limites</p>
                        <p>‚Ä¢ Configurar transfer√™ncias autom√°ticas para Conta Sonhos</p>
                    </div>

                    <div class="trigger-card">
                        <div class="trigger-type trigger-env">üè† Ambiental</div>
                        <p><strong>Exemplos:</strong></p>
                        <p>‚Ä¢ Manter apenas 1 cart√£o espec√≠fico na carteira</p>
                        <p>‚Ä¢ Colocar foto do sonho na tela do celular</p>
                        <p>‚Ä¢ Reorganizar apps financeiros por prioridade</p>
                    </div>

                    <div class="trigger-card">
                        <div class="trigger-type trigger-social">üë• Social</div>
                        <p><strong>Exemplos:</strong></p>
                        <p>‚Ä¢ Estabelecer parceiro de presta√ß√£o de contas</p>
                        <p>‚Ä¢ Comunicar regras a pessoas pr√≥ximas</p>
                        <p>‚Ä¢ Compartilhar progresso em grupo de apoio</p>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Configure Seus 3 Gatilhos</div>
                    <div id="triggersContainer"></div>
                </div>

                <div class="navigation">
                    <button class="nav-button secondary" onclick="prevStep()">
                        ‚Üê Voltar
                    </button>
                    <button class="nav-button primary" onclick="nextStep()">
                        Pr√≥ximo: Sistema de Revis√£o ‚Üí
                    </button>
                </div>
            </div>

            <!-- PASSO 3: REVIS√ïES -->
            <div class="step" id="step3">
                <h2 class="step-title">üìÖ Passo 3: Sistema de Revis√£o Peri√≥dica</h2>
                <p class="step-description">Configure revis√µes estrat√©gicas em vez de vigil√¢ncia constante.</p>

                <div class="success-box">
                    <p><strong>‚úÖ A Chave da Liberdade:</strong></p>
                    <p>Substitua o controle obsessivo di√°rio por <strong>revis√µes peri√≥dicas eficientes</strong>.</p>
                    <p>Isso elimina o estresse e mant√©m voc√™ no caminho certo!</p>
                </div>

                <div class="review-schedule">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h3 style="color: #92400e; font-size: 1.5em;">üìÜ Seu Calend√°rio de Revis√µes</h3>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-frequency">‚ö° Revis√£o R√°pida Semanal (15 minutos)</div>
                        <p style="color: #4a5568; margin-top: 5px;">
                            ‚úì Verificar saldos das 3 Contas<br>
                            ‚úì Conferir se regras est√£o sendo seguidas<br>
                            ‚úì Ajustes r√°pidos se necess√°rio
                        </p>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-frequency">üìä Revis√£o Completa Mensal (45 minutos)</div>
                        <p style="color: #4a5568; margin-top: 5px;">
                            ‚úì Avaliar progresso em dire√ß√£o aos sonhos<br>
                            ‚úì Analisar funcionamento das regras<br>
                            ‚úì Identificar vazamentos ou padr√µes<br>
                            ‚úì Celebrar conquistas do m√™s
                        </p>
                    </div>

                    <div class="schedule-item">
                        <div class="schedule-frequency">üîß Ajuste Trimestral (60 minutos)</div>
                        <p style="color: #4a5568; margin-top: 5px;">
                            ‚úì Revisar e ajustar todas as regras<br>
                            ‚úì Atualizar gatilhos conforme necess√°rio<br>
                            ‚úì Reavaliar metas e sonhos<br>
                            ‚úì Planejar pr√≥ximos 3 meses
                        </p>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">Configure Seus Lembretes</div>
                    
                    <div class="input-group">
                        <label>Dia da Semana para Revis√£o R√°pida Semanal</label>
                        <select id="weeklyDay" onchange="saveReviewSettings()">
                            <option value="">Selecione...</option>
                            <option value="domingo">Domingo</option>
                            <option value="segunda">Segunda-feira</option>
                            <option value="ter√ßa">Ter√ßa-feira</option>
                            <option value="quarta">Quarta-feira</option>
                            <option value="quinta">Quinta-feira</option>
                            <option value="sexta">Sexta-feira</option>
                            <option value="s√°bado">S√°bado</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Dia do M√™s para Revis√£o Completa Mensal</label>
                        <select id="monthlyDay" onchange="saveReviewSettings()">
                            <option value="">Selecione...</option>
                            <option value="1">Dia 1</option>
                            <option value="5">Dia 5</option>
                            <option value="10">Dia 10</option>
                            <option value="15">Dia 15</option>
                            <option value="20">Dia 20</option>
                            <option value="25">Dia 25</option>
                            <option value="ultimo">√öltimo dia do m√™s</option>
                        </select>
                    </div>

                    <div class="warning-box">
                        <p><strong>üí° Dica:</strong> Configure estes lembretes no seu calend√°rio (Google Calendar, Outlook, etc) <strong>AGORA MESMO</strong>!</p>
                        <p>N√£o deixe para depois - isso √© o que transforma inten√ß√£o em a√ß√£o.</p>
                    </div>
                </div>

                <div id="summarySection"></div>

                <div class="download-section">
                    <h3 style="margin-bottom: 20px; color: #2d3748;">‚úÖ Sistema Completo!</h3>
                    <p style="color: #718096; margin-bottom: 30px;">Salve seu Sistema de Delega√ß√£o Financeira</p>
                    <button class="download-button" onclick="showPrintView()">
                        üìÑ Ver Relat√≥rio Completo
                    </button>
                </div>

                <div class="navigation">
                    <button class="nav-button secondary" onclick="prevStep()">
                        ‚Üê Voltar
                    </button>
                    <button class="nav-button primary" onclick="restart()">
                        üîÑ Criar Novo Sistema
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Visualiza√ß√£o para Impress√£o -->
    <div class="print-view" id="printView">
        <div class="print-buttons">
            <button class="print-btn print-btn-primary" onclick="printReport()">üñ®Ô∏è Imprimir/Salvar PDF</button>
            <button class="print-btn print-btn-secondary" onclick="closePrintView()">‚úï Fechar</button>
        </div>
        <div class="print-content" id="printContent"></div>
    </div>

    <script>
        let currentStep = 1;
        let rules = [];
        let triggers = [];
        let reviewSettings = {};

        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateProgressBar();
            renderRules();
        });

        function addRule() {
            if (rules.length >= 5) {
                alert('Voc√™ j√° criou 5 regras! Para manter o sistema simples, mantenha no m√°ximo 5 regras.');
                return;
            }
            
            rules.push({
                if: '',
                then: '',
                because: ''
            });
            
            renderRules();
            saveData();
        }

        function removeRule(index) {
            if (confirm('Remover esta regra?')) {
                rules.splice(index, 1);
                renderRules();
                saveData();
            }
        }

        function updateRule(index, field, value) {
            rules[index][field] = value;
            saveData();
        }

        function renderRules() {
            const container = document.getElementById('rulesContainer');
            
            if (rules.length === 0) {
                // Iniciar com pelo menos 1 regra vazia
                rules.push({ if: '', then: '', because: '' });
            }

            container.innerHTML = rules.map((rule, index) => `
                <div class="rule-card">
                    <div class="rule-number">${index + 1}</div>
                    
                    <div class="input-group">
                        <label><span class="rule-label rule-if">SE</span> (situa√ß√£o espec√≠fica)</label>
                        <input type="text" 
                               placeholder="Ex: uma compra n√£o planejada custar mais de R$ 200"
                               value="${rule.if}"
                               onchange="updateRule(${index}, 'if', this.value)">
                    </div>

                    <div class="input-group">
                        <label><span class="rule-label rule-then">ENT√ÉO</span> (a√ß√£o clara)</label>
                        <input type="text" 
                               placeholder="Ex: esperarei 24 horas antes de decidir"
                               value="${rule.then}"
                               onchange="updateRule(${index}, 'then', this.value)">
                    </div>

                    <div class="input-group">
                        <label><span class="rule-label rule-because">PORQUE</span> (conex√£o com seu sonho)</label>
                        <textarea placeholder="Ex: cada decis√£o impulsiva adia a realiza√ß√£o da minha viagem para Portugal"
                                  onchange="updateRule(${index}, 'because', this.value)">${rule.because}</textarea>
                    </div>

                    ${rules.length > 1 ? `
                        <button class="remove-button" onclick="removeRule(${index})">
                            üóëÔ∏è Remover Regra
                        </button>
                    ` : ''}
                </div>
            `).join('');

            // Atualizar bot√£o de adicionar
            const addBtn = document.getElementById('addRuleBtn');
            if (rules.length >= 5) {
                addBtn.style.display = 'none';
            } else {
                addBtn.style.display = 'inline-flex';
            }
        }

        function nextStep() {
            if (validateStep(currentStep)) {
                currentStep++;
                showStep(currentStep);
                updateProgressBar();
                
                if (currentStep === 2) renderTriggers();
                if (currentStep === 3) renderSummary();
                
                saveData();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                updateProgressBar();
            }
        }

        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgressBar() {
            const progress = ((currentStep - 1) / 2) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentStep) step.classList.add('completed');
                else if (index + 1 === currentStep) step.classList.add('active');
            });
        }

        function validateStep(step) {
            if (step === 1) {
                if (rules.length === 0) {
                    alert('Crie pelo menos 1 regra financeira!');
                    return false;
                }
                
                let hasEmpty = false;
                rules.forEach(rule => {
                    if (!rule.if || !rule.then || !rule.because) {
                        hasEmpty = true;
                    }
                });
                
                if (hasEmpty) {
                    alert('Preencha todos os campos (SE, ENT√ÉO, PORQUE) de todas as regras!');
                    return false;
                }
            }
            
            if (step === 2) {
                if (triggers.length < 3) {
                    alert('Configure pelo menos 3 gatilhos (1 de cada tipo)!');
                    return false;
                }
                
                let hasTech = triggers.some(t => t.type === 'tech');
                let hasEnv = triggers.some(t => t.type === 'env');
                let hasSocial = triggers.some(t => t.type === 'social');
                
                if (!hasTech || !hasEnv || !hasSocial) {
                    alert('Configure pelo menos 1 gatilho de cada tipo (Tecnol√≥gico, Ambiental e Social)!');
                    return false;
                }
            }
            
            return true;
        }

        function renderTriggers() {
            const container = document.getElementById('triggersContainer');
            
            // Garantir que existem 3 gatilhos (1 de cada tipo)
            if (triggers.length === 0) {
                triggers = [
                    { type: 'tech', description: '', rule: '' },
                    { type: 'env', description: '', rule: '' },
                    { type: 'social', description: '', rule: '' }
                ];
            }

            const typeNames = {
                'tech': { name: 'üíª Tecnol√≥gico', class: 'trigger-tech' },
                'env': { name: 'üè† Ambiental', class: 'trigger-env' },
                'social': { name: 'üë• Social', class: 'trigger-social' }
            };

            container.innerHTML = triggers.map((trigger, index) => `
                <div class="trigger-card">
                    <div class="trigger-type ${typeNames[trigger.type].class}">
                        ${typeNames[trigger.type].name}
                    </div>

                    <div class="input-group">
                        <label>Para qual regra este gatilho serve?</label>
                        <select onchange="updateTrigger(${index}, 'rule', this.value)">
                            <option value="">Selecione uma regra...</option>
                            ${rules.map((rule, ruleIndex) => `
                                <option value="${ruleIndex}" ${trigger.rule == ruleIndex ? 'selected' : ''}>
                                    Regra ${ruleIndex + 1}: ${rule.if.substring(0, 50)}${rule.if.length > 50 ? '...' : ''}
                                </option>
                            `).join('')}
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Descreva o gatilho espec√≠fico</label>
                        <textarea placeholder="${trigger.type === 'tech' ? 'Ex: Configurar alerta no app do banco para gastos acima de R$ 200' : trigger.type === 'env' ? 'Ex: Colocar foto do meu sonho na tela de bloqueio do celular' : 'Ex: Avisar meu c√¥njuge sobre esta regra e pedir apoio'}"
                                  onchange="updateTrigger(${index}, 'description', this.value)">${trigger.description}</textarea>
                    </div>
                </div>
            `).join('');
        }

        function updateTrigger(index, field, value) {
            triggers[index][field] = value;
            saveData();
        }

        function saveReviewSettings() {
            reviewSettings.weeklyDay = document.getElementById('weeklyDay').value;
            reviewSettings.monthlyDay = document.getElementById('monthlyDay').value;
            saveData();
        }

        function renderSummary() {
            const container = document.getElementById('summarySection');
            
            container.innerHTML = `
                <div class="success-box">
                    <p><strong>üéâ Parab√©ns! Voc√™ criou seu Sistema de Delega√ß√£o Financeira:</strong></p>
                    <p>‚úÖ <strong>${rules.length}</strong> Regras Financeiras configuradas</p>
                    <p>‚úÖ <strong>${triggers.length}</strong> Gatilhos Autom√°ticos implementados</p>
                    <p>‚úÖ Sistema de Revis√£o Peri√≥dica configurado</p>
                    <p><br><strong>Resultado:</strong> Voc√™ eliminou a necessidade de controle obsessivo e liberou sua mente para o que realmente importa! üß†‚ú®</p>
                </div>
            `;
        }

        function showPrintView() {
            const html = `
                <div class="print-header">
                    <h1 style="font-size: 2.5em;">üß† Sistema de Delega√ß√£o Financeira</h1>
                    <p style="font-size: 1.2em;">Revolu√ß√£o Financeira em 30 Dias</p>
                    <p style="font-size: 0.9em; opacity: 0.8; margin-top: 10px;">${new Date().toLocaleDateString('pt-BR')}</p>
                </div>

                <div style="background: #e0e7ff; padding: 25px; border-radius: 12px; border-left: 4px solid #667eea; margin-bottom: 30px;">
                    <h2 style="color: #667eea; margin-bottom: 15px;">üìê Minhas ${rules.length} Regras Financeiras</h2>
                    
                    ${rules.map((rule, i) => `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                            <h3 style="color: #2d3748; margin-bottom: 15px;">Regra ${i + 1}</h3>
                            <p style="color: #4a5568; margin: 8px 0;">
                                <strong style="color: #dc2626;">SE</strong> ${rule.if}
                            </p>
                            <p style="color: #4a5568; margin: 8px 0;">
                                <strong style="color: #059669;">ENT√ÉO</strong> ${rule.then}
                            </p>
                            <p style="color: #4a5568; margin: 8px 0;">
                                <strong style="color: #ea580c;">PORQUE</strong> ${rule.because}
                            </p>
                        </div>
                    `).join('')}
                </div>

                <div style="background: #d1fae5; padding: 25px; border-radius: 12px; border-left: 4px solid #10b981; margin-bottom: 30px;">
                    <h2 style="color: #065f46; margin-bottom: 15px;">üéØ Meus ${triggers.length} Gatilhos Autom√°ticos</h2>
                    
                    ${triggers.map((trigger, i) => {
                        const typeNames = {
                            'tech': 'üíª Tecnol√≥gico',
                            'env': 'üè† Ambiental',
                            'social': 'üë• Social'
                        };
                        const ruleText = trigger.rule !== '' && rules[trigger.rule] ? rules[trigger.rule].if : 'N√£o especificado';
                        
                        return `
                            <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                                <p style="color: #667eea; font-weight: 700; margin-bottom: 10px;">${typeNames[trigger.type]}</p>
                                <p style="color: #4a5568; margin: 5px 0;">
                                    <strong>Para a regra:</strong> ${ruleText.substring(0, 80)}${ruleText.length > 80 ? '...' : ''}
                                </p>
                                <p style="color: #4a5568; margin: 5px 0;">
                                    <strong>Gatilho:</strong> ${trigger.description}
                                </p>
                            </div>
                        `;
                    }).join('')}
                </div>

                <div style="background: #fef3c7; padding: 25px; border-radius: 12px; border-left: 4px solid #f59e0b; margin-bottom: 30px;">
                    <h2 style="color: #92400e; margin-bottom: 15px;">üìÖ Meu Sistema de Revis√£o</h2>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p style="color: #92400e; font-weight: 700;">‚ö° Revis√£o R√°pida Semanal (15 min)</p>
                        <p style="color: #4a5568; margin-top: 5px;">
                            ${reviewSettings.weeklyDay ? 'Toda ' + reviewSettings.weeklyDay : 'Ainda n√£o configurado'}
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p style="color: #92400e; font-weight: 700;">üìä Revis√£o Completa Mensal (45 min)</p>
                        <p style="color: #4a5568; margin-top: 5px;">
                            ${reviewSettings.monthlyDay ? 'Todo dia ' + reviewSettings.monthlyDay + ' do m√™s' : 'Ainda n√£o configurado'}
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <p style="color: #92400e; font-weight: 700;">üîß Ajuste Trimestral (60 min)</p>
                        <p style="color: #4a5568; margin-top: 5px;">A cada 3 meses</p>
                    </div>
                </div>

                <div style="background: #d1fae5; padding: 25px; border-radius: 12px; border-left: 4px solid #10b981;">
                    <h2 style="color: #065f46; margin-bottom: 15px;">üí° Lembre-se</h2>
                    <p style="color: #065f46; line-height: 1.8;">
                        O objetivo n√£o √© <strong>controlar obsessivamente cada centavo</strong>, mas construir um <strong>sistema que toma decis√µes alinhadas com seus sonhos automaticamente</strong>. 
                        Voc√™ agora tem regras claras, gatilhos autom√°ticos e um sistema de revis√£o peri√≥dica. Isso elimina 90% do estresse financeiro e libera sua mente para o que realmente importa!
                    </p>
                </div>

                <div style="text-align: center; margin-top: 40px; padding-top: 30px; border-top: 2px solid #e9ecef; color: #718096;">
                    <p style="font-size: 1.1em; margin-bottom: 15px;"><strong>üß† Voc√™ construiu uma revolu√ß√£o financeira que trabalha enquanto voc√™ dorme!</strong></p>
                    <p style="font-size: 0.9em; margin-top: 20px; color: #667eea;"><strong>Revolu√ß√£o Financeira em 30 Dias</strong></p>
                    <p style="font-size: 0.85em; color: #667eea;">Fernando Martins</p>
                    <p style="font-size: 0.85em; color: #667eea;">Consultor Financeiro</p>
                </div>
            `;

            document.getElementById('printContent').innerHTML = html;
            document.getElementById('printView').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closePrintView() {
            document.getElementById('printView').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function printReport() {
            window.print();
        }

        function saveData() {
            localStorage.setItem('delegationSystem', JSON.stringify({
                rules,
                triggers,
                reviewSettings
            }));
        }

        function loadData() {
            const saved = localStorage.getItem('delegationSystem');
            if (saved) {
                const data = JSON.parse(saved);
                rules = data.rules || [];
                triggers = data.triggers || [];
                reviewSettings = data.reviewSettings || {};
                
                if (reviewSettings.weeklyDay) {
                    document.getElementById('weeklyDay').value = reviewSettings.weeklyDay;
                }
                if (reviewSettings.monthlyDay) {
                    document.getElementById('monthlyDay').value = reviewSettings.monthlyDay;
                }
            }
        }

        function restart() {
            if (confirm('Criar um novo sistema? Os dados atuais ser√£o perdidos.')) {
                localStorage.removeItem('delegationSystem');
                location.reload();
            }
        }
    </script>
</body>
</html>
